<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#0a1a2f">
<title>Tilawah Focus</title>
<style>
:root{
  --bg1:#0a1a2f;
  --bg2:#10384f;
  --glass-bg:rgba(255,255,255,0.08);
  --text:#f0f8ff;
  --accent:#4dd4b0;
  --weak:#d47979;
  --medium:#e8d177;
  --strong:#9ce89c;
  --arabic-font:'Scheherazade New', serif;
  --latin-font:'Poppins', sans-serif;
}
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&family=Scheherazade+New&display=swap');
*{box-sizing:border-box;margin:0;padding:0;font-family:var(--latin-font);}
body{
  background:linear-gradient(120deg,var(--bg1),var(--bg2));
  color:var(--text);
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  overflow-x:hidden;
}
canvas#bgAnim{
  position:fixed;top:0;left:0;width:100%;height:100%;
  z-index:-1;
}
header{
  text-align:center;
  padding:2rem 1rem;
}
h1{font-size:1.8rem;letter-spacing:1px;}
nav{display:flex;justify-content:center;flex-wrap:wrap;gap:1rem;margin:1rem 0;}
nav button{
  background:var(--glass-bg);
  border:none;
  color:var(--text);
  padding:0.7rem 1.4rem;
  border-radius:25px;
  backdrop-filter:blur(8px);
  cursor:pointer;
  transition:all .3s;
}
nav button:hover{
  background:rgba(255,255,255,0.15);
  transform:scale(1.05);
}
section{
  display:none;
  width:90%;
  max-width:600px;
  background:var(--glass-bg);
  border-radius:20px;
  backdrop-filter:blur(12px);
  padding:1.5rem;
  margin-bottom:3rem;
  animation:fadeIn .5s ease;
}
section.active{display:block;}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:none;}}
button.primary{
  background:var(--accent);
  color:#003;
  padding:0.7rem 1.4rem;
  border:none;
  border-radius:25px;
  cursor:pointer;
  transition:.3s;
}
button.primary:hover{background:#6ee0c0;}
.timer-display{
  font-size:3rem;
  text-align:center;
  margin:1rem 0;
}
.ayah{
  font-family:var(--arabic-font);
  font-size:1.4rem;
  text-align:center;
  line-height:2.2rem;
  margin-top:1rem;
}
.motivation-card{
  background:rgba(255,255,255,0.08);
  border-radius:15px;
  padding:1rem;
  margin:1rem 0;
  text-align:center;
  transition:transform .3s,box-shadow .3s;
}
.motivation-card:hover{
  transform:translateY(-5px) scale(1.03);
  box-shadow:0 0 20px rgba(255,255,255,0.1);
}
.dua{margin:1rem 0;text-align:center;}
.dua .arabic{font-family:var(--arabic-font);font-size:1.3rem;line-height:2.2rem;}
.dua .meaning{margin-top:0.5rem;font-size:0.95rem;}
input,textarea{
  width:100%;
  background:rgba(255,255,255,0.1);
  border:none;
  border-radius:10px;
  color:var(--text);
  padding:0.6rem;
  margin-top:0.5rem;
}
.hifz-item{
  display:flex;justify-content:space-between;align-items:center;
  padding:0.6rem;
  border-bottom:1px solid rgba(255,255,255,0.1);
}
.hifz-item span{flex:1;}
.hifz-item select{
  background:rgba(255,255,255,0.1);
  color:var(--text);
  border:none;
  border-radius:8px;
  padding:0.3rem;
}
.progress-bar{
  height:8px;border-radius:5px;background:rgba(255,255,255,0.1);margin-top:1rem;
}
.progress-bar div{
  height:8px;border-radius:5px;background:var(--accent);width:0%;
  transition:width 0.5s ease;
}
.streak{text-align:center;margin-top:1rem;font-size:1rem;}
.reflection{margin-top:1rem;}
@media(max-width:600px){
  h1{font-size:1.5rem;}
}
</style>
</head>
<body>
<canvas id="bgAnim"></canvas>
<header>
  <h1>Tilawah Focus</h1>
  <p>Qur’on bilan xotirjamlik va diqqat</p>
</header>
<nav>
  <button data-target="focus">Tilawah Fokusi</button>
  <button data-target="motivations">Ilhomlar</button>
  <button data-target="duas">Duolar</button>
  <button data-target="hifz">Hifz reja</button>
  <button data-target="streak">Barqarorlik</button>
</nav>

<section id="focus" class="active">
  <h2>Tilawah Fokusi</h2>
  <div class="session-options" style="text-align:center;margin:1rem 0;">
    <button class="primary" data-min="25">25 daqiqa</button>
    <button class="primary" data-min="45">45 daqiqa</button>
    <button class="primary" data-min="60">60 daqiqa</button>
  </div>
  <div class="timer-display" id="timer">00:00</div>
  <div class="ayah" id="focus-ayah"></div>
  <div class="reflection">
    <label for="reflectionText">Bugungi tafakkur:</label>
    <textarea id="reflectionText" rows="3" placeholder="Fikrlaringizni yozing..."></textarea>
    <button class="primary" id="saveReflection">Saqlash</button>
  </div>
</section>

<section id="motivations">
  <h2>Qur’on ilhomlari</h2>
  <div id="motivationList"></div>
</section>

<section id="duas">
  <h2>Duolar va Niyat</h2>
  <div id="duasList"></div>
  <h3>Mening niyatim</h3>
  <input type="text" id="intentionInput" placeholder="Niyatim...">
  <button class="primary" id="saveIntention">Saqlash</button>
</section>

<section id="hifz">
  <h2>Hifz va Muroja’ah reja</h2>
  <div id="hifzList"></div>
  <button class="primary" id="addHifz">Yangi oyat qo‘shish</button>
  <div class="progress-bar"><div id="hifzProgress"></div></div>
</section>

<section id="streak">
  <h2>Barqarorlik</h2>
  <div class="streak" id="streakText"></div>
</section>

<script>
// Background animation - flowing gradient waves
const canvas=document.getElementById('bgAnim');
const ctx=canvas.getContext('2d');
let w,h,time=0;
function resize(){w=canvas.width=window.innerWidth;h=canvas.height=window.innerHeight;}
window.addEventListener('resize',resize);resize();
function wave(t,x,o){return Math.sin((x/100)+t+o)*20;}
function draw(){
 ctx.clearRect(0,0,w,h);
 let grd=ctx.createLinearGradient(0,0,w,h);
 grd.addColorStop(0,'#0a1a2f');
 grd.addColorStop(1,'#10384f');
 ctx.fillStyle=grd;ctx.fillRect(0,0,w,h);
 ctx.beginPath();
 for(let x=0;x<=w;x++){
   let y=h/2+wave(time/20,x,0)+wave(time/40,x,2)+wave(time/50,x,5);
   x==0?ctx.moveTo(x,y):ctx.lineTo(x,y);
 }
 ctx.lineTo(w,h);ctx.lineTo(0,h);ctx.closePath();
 ctx.fillStyle='rgba(77,212,176,0.1)';
 ctx.fill();
 time+=1;
 requestAnimationFrame(draw);
}
draw();

// Navigation
const buttons=document.querySelectorAll('nav button');
const sections=document.querySelectorAll('section');
buttons.forEach(btn=>{
  btn.onclick=()=>{
    sections.forEach(s=>s.classList.remove('active'));
    document.getElementById(btn.dataset.target).classList.add('active');
  };
});

// Data
const ayahs=[
{ar:'أَلَا بِذِكْرِ اللَّهِ تَطْمَئِنُّ الْقُلُوبُ',uz:'Albatta, qalblar Allohni zikr qilish bilan xotirjam bo‘lur. (Ra’d, 28)'},
{ar:'وَقُل رَّبِّ زِدْنِي عِلْمًا',uz:'Parvardigorim, ilmimni ziyoda qil. (Toha, 114)'},
{ar:'فَإِنَّ مَعَ الْعُسْرِ يُسْرًا',uz:'Albatta, qiyinchilik bilan birga yengillik bor. (Sharh, 6)'},
{ar:'إِنَّ اللَّهَ مَعَ الصَّابِرِينَ',uz:'Albatta, Alloh sabr qiluvchilar bilan birgadir. (Baqara, 153)'}
];
const motivations=[
"Qur’on bilan o‘tirgan qalb hech qachon yolg‘iz bo‘lmaydi.",
"Bugun oz o‘qidim deme — davomli o‘qish Allohga suyuklidir.",
"Bir oyat bilan yashash, ming rejasiz kundan afzaldir.",
"Qur’on seni o‘zgartirmay qolsa, sen unga hali yetib bormagansan.",
"Til charchashi mumkin, qalb charchamaydi — davom et.",
"Hifz sabr bilan bitadi, shoshilish bilan buziladi.",
"Bugungi ozgina muroja’ah — ertangi mustahkamlik.",
"Qur’onni tez tugatish emas, sog‘lom olib yurish maqsad.",
"Alloh Qur’on bilan band bo‘lgan qalbni sinmaydigan qiladi.",
"Yoddan chiqqan oyat gunoh emas, tashlab qo‘yilgan oyat xatardir."
];
const duas=[
{ar:"اللّهُمَّ اجعل القرآن ربيع قلبي",uz:"Allohim, Qur’onni qalbimning bahoriga aylantir."},
{ar:"اللّهُمَّ ثبّت ما حفظتُ وذكّرني ما نُسِّيت",uz:"Allohim, yodlaganimni mustahkam qil, unutganimni eslat."},
{ar:"رَبِّ اشْرَحْ لِي صَدْرِي",uz:"Robbim, ko‘nglimni keng qil."},
{ar:"اللّهُمَّ لا تجعل القرآن حجةً عليّ بل حجةً لي",uz:"Allohim, Qur’onni menga qarshi emas, men uchun hujjat qil."}
];

// Focus timer
let timerInterval,remaining=0;
const timerDisplay=document.getElementById('timer');
const focusAyah=document.getElementById('focus-ayah');
document.querySelectorAll('.session-options button').forEach(b=>{
 b.onclick=()=>{
   startFocus(b.dataset.min);
 };
});
function startFocus(min){
 clearInterval(timerInterval);
 remaining=min*60;
 const ayah=ayahs[Math.floor(Math.random()*ayahs.length)];
 focusAyah.innerHTML=`<div>${ayah.ar}</div><div style="font-size:0.9rem;margin-top:0.5rem;">${ayah.uz}</div>`;
 smoothUpdate();
 timerInterval=setInterval(()=>{
   remaining--;
   smoothUpdate();
   if(remaining<=0){
     clearInterval(timerInterval);
     endFocus();
   }
 },1000);
}
function smoothUpdate(){
 let m=Math.floor(remaining/60).toString().padStart(2,'0');
 let s=(remaining%60).toString().padStart(2,'0');
 timerDisplay.textContent=`${m}:${s}`;
}
function endFocus(){
 const msg=motivations[Math.floor(Math.random()*motivations.length)];
 focusAyah.innerHTML=`<div style="margin-top:1rem;">${msg}</div>`;
}

// Reflections
const reflectionText=document.getElementById('reflectionText');
const savedRef=localStorage.getItem('reflection')||'';
reflectionText.value=savedRef;
document.getElementById('saveReflection').onclick=()=>{
 localStorage.setItem('reflection',reflectionText.value);
 alert('Tafakkur saqlandi.');
};

// Motivations list
const motList=document.getElementById('motivationList');
motivations.forEach(m=>{
 const div=document.createElement('div');
 div.className='motivation-card';
 div.textContent=m;
 motList.appendChild(div);
});

// Duas
const duasList=document.getElementById('duasList');
duas.forEach(d=>{
 const div=document.createElement('div');
 div.className='dua';
 div.innerHTML=`<div class="arabic">${d.ar}</div><div class="meaning">${d.uz}</div>`;
 duasList.appendChild(div);
});
const intentionInput=document.getElementById('intentionInput');
intentionInput.value=localStorage.getItem('intention')||'';
document.getElementById('saveIntention').onclick=()=>{
 localStorage.setItem('intention',intentionInput.value);
 alert('Niyat saqlandi.');
};

// Hifz planner
let hifz=JSON.parse(localStorage.getItem('hifz')||'[]');
const hifzList=document.getElementById('hifzList');
function renderHifz(){
 hifzList.innerHTML='';
 hifz.forEach((item,i)=>{
   const div=document.createElement('div');
   div.className='hifz-item';
   div.innerHTML=`<span>${item.text}</span>
   <select data-i="${i}">
     <option value="weak" ${item.status==='weak'?'selected':''}>Zaif</option>
     <option value="medium" ${item.status==='medium'?'selected':''}>O‘rtacha</option>
     <option value="strong" ${item.status==='strong'?'selected':''}>Mustahkam</option>
   </select>`;
   hifzList.appendChild(div);
 });
 updateProgress();
}
renderHifz();
hifzList.addEventListener('change',e=>{
 if(e.target.tagName==='SELECT'){
   const i=e.target.dataset.i;
   hifz[i].status=e.target.value;
   localStorage.setItem('hifz',JSON.stringify(hifz));
   updateProgress();
 }
});
document.getElementById('addHifz').onclick=()=>{
 const text=prompt("O‘rganiladigan oyat:");
 if(!text)return;
 hifz.push({text,status:'weak'});
 localStorage.setItem('hifz',JSON.stringify(hifz));
 renderHifz();
};
function updateProgress(){
 const bar=document.getElementById('hifzProgress');
 if(hifz.length===0){bar.style.width='0%';return;}
 const strong=hifz.filter(i=>i.status==='strong').length;
 const pct=Math.round((strong/hifz.length)*100);
 bar.style.width=pct+'%';
}

// Streak system
function getStreak(){
 const last=localStorage.getItem('lastFocusDate');
 const today=new Date().toDateString();
 let count=parseInt(localStorage.getItem('streakCount')||'0');
 if(last!==today){
   const diff=last?Math.floor((new Date(today)-new Date(last))/86400000):1;
   if(diff===1)count++;
   else count=1;
   localStorage.setItem('streakCount',count);
   localStorage.setItem('lastFocusDate',today);
 }
 return count;
}
function streakLabel(c){
 if(c>=40)return"Qalbga singdi";
 if(c>=21)return"Mustahkam yo‘l";
 if(c>=7)return"Qur’on bilan odat";
 if(c>=3)return"Barqaror qadam";
 if(c>=1)return"Boshlanish";
 return"Boshlanish";
}
const streakCount=getStreak();
document.getElementById('streakText').textContent=`${streakCount} kun — ${streakLabel(streakCount)}`;
</script>
</body>
</html>