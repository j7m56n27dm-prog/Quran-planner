<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Tilawah Focus — Advanced</title>

<style>
:root{
--bg:#050812;
--glass:rgba(255,255,255,.08);
--border:rgba(255,255,255,.18);
--accent:#2dd4bf;
--danger:#ef476f;
--text:#f6f7fb;
--muted:#b5bddc;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
font-family:system-ui,Segoe UI,Roboto;
background:radial-gradient(1200px 800px at 50% -20%,#1b2a6d,var(--bg) 65%);
color:var(--text);
min-height:100vh;
overflow:hidden;
}

/* ===== PARTICLES ===== */
canvas{
position:fixed;
inset:0;
z-index:-1;
}

/* ===== LAYOUT ===== */
.app{
max-width:420px;
margin:auto;
padding:24px;
}

.card{
background:var(--glass);
border:1px solid var(--border);
border-radius:22px;
padding:22px;
backdrop-filter:blur(18px);
box-shadow:0 20px 50px rgba(0,0,0,.35);
animation:fade .8s ease;
}

@keyframes fade{
from{opacity:0;transform:translateY(20px)}
to{opacity:1;transform:none}
}

.ayah-ar{
font-family:serif;
font-size:28px;
line-height:1.9;
text-align:center;
}

.ayah-uz{
text-align:center;
font-size:14px;
color:var(--muted);
margin-top:6px;
}

.timer{
font-size:72px;
text-align:center;
margin:24px 0;
letter-spacing:2px;
}

.controls{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:10px;
}

button{
padding:10px 18px;
border-radius:14px;
border:none;
cursor:pointer;
font-weight:600;
background:var(--accent);
color:#022;
transition:.25s;
}

button.stop{
background:var(--danger);
color:#fff;
}

button:hover{transform:scale(1.05)}

.status{
margin-top:14px;
font-size:13px;
text-align:center;
color:var(--muted);
}
</style>
</head>

<body>

<canvas id="bg"></canvas>

<div class="app">
<div class="card">

<div class="ayah-ar" id="ayahAr"></div>
<div class="ayah-uz" id="ayahUz"></div>

<div class="timer" id="timer">25:00</div>

<div class="controls">
<button onclick="engine.start(25)">25</button>
<button onclick="engine.start(45)">45</button>
<button onclick="engine.start(60)">60</button>
<button class="stop" onclick="engine.stop()">Stop</button>
</div>

<div class="status" id="status"></div>

</div>
</div>

<script>
/* ================= PARTICLE BACKGROUND ================= */
const c=document.getElementById("bg"),ctx=c.getContext("2d");
let w,h,stars=[];
function resize(){
w=c.width=window.innerWidth;
h=c.height=window.innerHeight;
stars=Array.from({length:120},()=>({
x:Math.random()*w,
y:Math.random()*h,
r:Math.random()*1.5+0.3,
v:Math.random()*0.3+0.1
}));
}
window.onresize=resize;resize();

function draw(){
ctx.clearRect(0,0,w,h);
ctx.fillStyle="white";
stars.forEach(s=>{
ctx.globalAlpha=.6;
ctx.beginPath();
ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
ctx.fill();
s.y-=s.v;
if(s.y<0)s.y=h;
});
requestAnimationFrame(draw);
}
draw();

/* ================= SMART ENGINE ================= */
const ayahs=[
["أَلَا بِذِكْرِ اللَّهِ تَطْمَئِنُّ الْقُلُوبُ","Qalblar Allohni zikr qilish bilan xotirjam bo‘lur."],
["وَقُل رَّبِّ زِدْنِي عِلْمًا","Parvardigorim, ilmimni ziyoda qil."],
["إِنَّ اللَّهَ مَعَ الصَّابِرِينَ","Alloh sabr qiluvchilar bilan birgadir."],
["فَإِنَّ مَعَ الْعُسْرِ يُسْرًا","Qiyinchilik bilan birga yengillik bor."]
];

const engine={
state:"idle",
end:0,
raf:null,

start(min){
this.stop();
this.state="running";
this.end=Date.now()+min*60000;
this.pickAyah();
this.tick();
status.textContent="Fokus boshlandi…";
},

stop(){
if(this.raf)cancelAnimationFrame(this.raf);
this.state="idle";
status.textContent="To‘xtatildi";
},

tick(){
if(this.state!=="running")return;
const diff=Math.max(0,this.end-Date.now());
const sec=Math.ceil(diff/1000);
const m=String(Math.floor(sec/60)).padStart(2,"0");
const s=String(sec%60).padStart(2,"0");
timer.textContent=`${m}:${s}`;
if(diff>0){
this.raf=requestAnimationFrame(this.tick.bind(this));
}else{
this.complete();
}
},

complete(){
this.state="idle";
status.textContent="Yakunlandi. Alloh baraka bersin.";
this.saveSession();
},

pickAyah(){
const a=ayahs[Math.floor(Math.random()*ayahs.length)];
ayahAr.textContent=a[0];
ayahUz.textContent=a[1];
},

saveSession(){
const list=JSON.parse(localStorage.getItem("sessions")||"[]");
list.push({date:new Date().toISOString()});
localStorage.setItem("sessions",JSON.stringify(list));
}
};

engine.pickAyah();
status.textContent="Tayyor";
</script>

</body>
</html>